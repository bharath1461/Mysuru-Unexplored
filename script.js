// Mysuru Unexplored - Tourism Platform Data
const data = {
    categories: [
        { id: 'hidden-places', name: 'Hidden Places', icon: 'fa-landmark', description: 'Discover Mysore\'s secret locations' },
        { id: 'local-artisans', name: 'Local Artisans', icon: 'fa-hands', description: 'Meet traditional craftspeople' },
        { id: 'cultural-experiences', name: 'Cultural Experiences', icon: 'fa-theater-masks', description: 'Immerse in local traditions' },
        { id: 'traditional-food', name: 'Traditional Food', icon: 'fa-utensils', description: 'Savor authentic flavors' }
    ],
    artisans: [
        // Channapatna Toy Maker
        {
            id: 1,
            name: 'Channapatna Toy Maker',
            description: 'Traditional wooden toy maker specializing in Channapatna lacquered toys.',
            rating: 4.8,
            distance: '10 km away',
            category: 'Local Artisans',
            subcategory: 'handicrafts',
            image: 'data:image/jpeg;base64,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',
            location: 'Bannimantap',
            address: 'Main Street, Bannimantap, Mysore',
            hours: '9:00 AM - 6:00 PM',
            contact: '+91 98765 43210',
            email: 'toys@example.com',
            story: 'Creating traditional Channapatna wooden toys using natural dyes and eco-friendly materials.',
            highlights: ['Heritage Craft', 'Eco-friendly Colors', 'Handmade'],
            price: '₹50 - ₹500',
            verified: true,
            coordinates: [12.3000, 76.6500],
            approved: true
        },
        // Mysore Silk Weaver
        {
            id: 2,
            name: 'Mysore Silk Weaver',
            description: 'Master weaver creating authentic Mysore silk sarees and fabrics.',
            rating: 4.9,
            distance: '2 km away',
            category: 'Local Artisans',
            subcategory: 'textiles',
            image: 'https://images.unsplash.com/photo-1662904262396-699c0003d88f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Agrahara',
            address: 'Silk Colony, Agrahara, Mysore',
            hours: '10:00 AM - 7:00 PM',
            contact: '+91 98765 43211',
            email: 'silk@example.com',
            story: 'Master weaver creating authentic Mysore silk sarees with traditional motifs and techniques.',
            highlights: ['Certified', 'Traditional Method', 'Pure Silk'],
            price: '₹1000 - ₹10000',
            verified: true,
            coordinates: [12.2985, 76.6338],
            approved: true
        },
        // Stone Sculptor
        {
            id: 3,
            name: 'Stone Sculptor',
            description: 'Traditional stone sculptor creating intricate temple art and sculptures.',
            rating: 4.7,
            distance: '15 km away',
            category: 'Local Artisans',
            subcategory: 'sculpture',
            image: 'https://images.unsplash.com/photo-1537602114470-9c68d50ca8d3?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Nanjangud',
            address: 'Temple Road, Nanjangud, Mysore',
            hours: '8:00 AM - 5:00 PM',
            contact: '+91 98765 43212',
            email: 'sculptor@example.com',
            story: 'Creating intricate stone sculptures with traditional techniques passed down through generations.',
            highlights: ['Heritage Art', 'Custom Orders', 'Temple Craft'],
            price: '₹5000 - ₹50000',
            verified: true,
            coordinates: [12.1833, 76.6833],
            approved: true
        }
    ],
    places: [
        // Kukkarahalli Lake Back Path
        {
            id: 1,
            name: 'Kukkarahalli Lake Back Path',
            description: 'Tranquil walking path behind Kukkarahalli Lake with scenic views.',
            rating: 4.5,
            distance: '3 km away',
            category: 'Hidden Places',
            subcategory: 'nature',
            image: 'https://images.unsplash.com/photo-1493246507139-91e8fad9978e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Jayalakshmipuram',
            address: 'Behind Kukkarahalli Lake, Jayalakshmipuram, Mysore',
            hours: '6:00 AM - 7:00 PM',
            contact: 'Available on request',
            email: 'hiddenplaces@example.com',
            story: 'A serene path that offers beautiful views of the lake and surrounding nature.',
            highlights: ['Scenic Views', 'Bird Watching', 'Tranquil'],
            price: 'Free',
            verified: true,
            coordinates: [12.2958, 76.6392],
            approved: true
        },
        // Lingambudhi Bird Sanctuary
        {
            id: 2,
            name: 'Lingambudhi Bird Sanctuary',
            description: 'Undiscovered bird sanctuary with diverse avian species.',
            rating: 4.6,
            distance: '8 km away',
            category: 'Hidden Places',
            subcategory: 'sanctuary',
            image: 'https://images.unsplash.com/photo-1501854140801-50d01698950b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Lingambudhi',
            address: 'Lingambudhi Village, Mysore',
            hours: '6:00 AM - 5:00 PM',
            contact: 'Available on request',
            email: 'birds@example.com',
            story: 'A peaceful sanctuary home to various bird species and native flora.',
            highlights: ['Bird Watching', 'Nature Walk', 'Peaceful'],
            price: '₹30',
            verified: true,
            coordinates: [12.2658, 76.6092],
            approved: true
        },
        // Karighatta Hill Viewpoint
        {
            id: 3,
            name: 'Karighatta Hill Viewpoint',
            description: 'Secluded hilltop with breathtaking views of Mysore city.',
            rating: 4.7,
            distance: '14 km away',
            category: 'Hidden Places',
            subcategory: 'viewpoint',
            image: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Nanjangud',
            address: 'Near Karighatta Temple, Nanjangud, Mysore',
            hours: '5:00 AM - 6:00 PM',
            contact: 'Available on request',
            email: 'viewpoint@example.com',
            story: 'A hidden gem offering panoramic views of Mysore city and surrounding landscapes.',
            highlights: ['Panoramic Views', 'Nature Photography', 'Sunset Spot'],
            price: '₹20',
            verified: true,
            coordinates: [12.1833, 76.6833],
            approved: true
        }
    ],
    experiences: [
        // Doll Making Workshop
        {
            id: 1,
            name: 'Traditional Doll Making Workshop',
            description: 'Learn traditional doll making techniques from master artisans.',
            rating: 4.6,
            distance: '2 km away',
            category: 'Cultural Experiences',
            subcategory: 'workshop',
            image: 'https://images.unsplash.com/photo-1517232115160-ff93364542dd?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Mysuru',
            address: 'Cultural Center, Mysore',
            hours: '2:00 PM - 5:00 PM',
            contact: '+91 98765 43213',
            email: 'workshop@example.com',
            story: 'Experience the art of traditional doll making with expert guidance.',
            highlights: ['Hands-on Learning', 'Cultural Experience', 'Take Home'],
            price: '₹300 - ₹500',
            verified: true,
            coordinates: [12.2958, 76.6392],
            approved: true
        },
        // Yakshagana Evening Practice
        {
            id: 2,
            name: 'Evening Yakshagana Practice',
            description: 'Watch evening Yakshagana practice sessions with artists.',
            rating: 4.8,
            distance: '4 km away',
            category: 'Cultural Experiences',
            subcategory: 'performance',
            image: 'https://images.unsplash.com/photo-1544636331-e26879cd4d9b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Outskirts',
            address: 'Community Hall, Mysore Outskirts',
            hours: '6:00 PM - 9:00 PM',
            contact: '+91 98765 43214',
            email: 'yakshagana@example.com',
            story: 'Witness the practice sessions of traditional Yakshagana performers.',
            highlights: ['Performance', 'Cultural Immersion', 'Interactive'],
            price: '₹150',
            verified: true,
            coordinates: [12.2858, 76.6292],
            approved: true
        },
        // Temple Flower Market Walk
        {
            id: 3,
            name: 'Temple Flower Market Walk',
            description: 'Guided walk through the vibrant flower market near temples.',
            rating: 4.5,
            distance: '1 km away',
            category: 'Cultural Experiences',
            subcategory: 'tour',
            image: 'https://images.unsplash.com/photo-1493246507139-91e8fad9978e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Devaraja Market',
            address: 'Old Market Area, Devaraja Market, Mysore',
            hours: '7:00 AM - 10:00 AM',
            contact: '+91 98765 43215',
            email: 'flowermarket@example.com',
            story: 'Explore the colorful flower market with insights into its cultural significance.',
            highlights: ['Cultural Tour', 'Flower Knowledge', 'Local Interaction'],
            price: '₹200',
            verified: true,
            coordinates: [12.2885, 76.6288],
            approved: true
        }
    ],
    food: [
        // Mylari Dosa
        {
            id: 1,
            name: 'Mylari Dosa',
            description: 'Authentic Mylari dosa served with special chutneys and sambar.',
            rating: 4.7,
            distance: '6 km away',
            category: 'Traditional Food',
            subcategory: 'breakfast',
            image: 'https://images.unsplash.com/photo-1555939594-58d7cb561ad1?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Nazarbad',
            address: 'Food Street, Nazirabad, Mysore',
            hours: '7:00 AM - 11:00 AM',
            contact: '+91 98765 43216',
            email: 'mylari@example.com',
            story: 'Serving authentic Mylari dosa with traditional preparation methods.',
            highlights: ['Authentic Taste', 'Traditional Recipe', 'Popular'],
            price: '₹30 - ₹60',
            verified: true,
            coordinates: [12.3078, 76.6472],
            approved: true
        },
        // Vinayaka Mylari
        {
            id: 2,
            name: 'Vinayaka Mylari',
            description: 'Traditional Mylari sweet shop serving homemade sweets since 1950.',
            rating: 4.6,
            distance: '2 km away',
            category: 'Traditional Food',
            subcategory: 'sweets',
            image: 'https://images.unsplash.com/photo-1563379926898-0ee016ec89d6?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Agrahara',
            address: 'Temple Road, Agrahara, Mysore',
            hours: '10:00 AM - 9:00 PM',
            contact: '+91 98765 43217',
            email: 'vinayaka@example.com',
            story: 'Family-owned sweet shop with recipes passed down through generations.',
            highlights: ['Heritage Sweet Shop', 'Family Recipe', 'Fresh Made'],
            price: '₹50 - ₹200',
            verified: true,
            coordinates: [12.2985, 76.6338],
            approved: true
        },
        // RRR Restaurant
        {
            id: 3,
            name: 'RRR Restaurant',
            description: 'Multi-cuisine restaurant serving traditional Karnataka dishes.',
            rating: 4.4,
            distance: '1 km away',
            category: 'Traditional Food',
            subcategory: 'multi-cuisine',
            image: 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: 'Gandhi Square',
            address: 'Gandhi Square, Mysore',
            hours: '11:00 AM - 10:00 PM',
            contact: '+91 98765 43218',
            email: 'rrr@example.com',
            story: 'Multi-cuisine restaurant featuring traditional Karnataka and regional specialties.',
            highlights: ['Traditional', 'Vegetarian', 'Affordable'],
            price: '₹150 - ₹300',
            verified: true,
            coordinates: [12.2958, 76.6392],
            approved: true
        }
    ],
    locations: [
        { id: 'agrahara', name: 'Agrahara', population: 'High', crowdLevel: 'Very Crowded', alternative: 'Bannimantap', coordinates: [12.2985, 76.6338], density: 0.9 },
        { id: 'nanjangud', name: 'Nanjangud', population: 'Medium', crowdLevel: 'Moderately Crowded', alternative: 'Chamrajpet', coordinates: [12.1833, 76.6833], density: 0.6 },
        { id: 'bannimantap', name: 'Bannimantap', population: 'Low', crowdLevel: 'Peaceful', alternative: 'None needed', coordinates: [12.3000, 76.6500], density: 0.2 },
        { id: 'chamrajpet', name: 'Chamrajpet', population: 'High', crowdLevel: 'Very Crowded', alternative: 'Devaraja Mohalla', coordinates: [12.3050, 76.6450], density: 0.8 },
        { id: 'devarajamohalla', name: 'Devaraja Mohalla', population: 'Medium', crowdLevel: 'Moderately Crowded', alternative: 'Vijayanagar', coordinates: [12.2885, 76.6288], density: 0.5 }
    ],
    reviews: [
        { artisanId: 1, name: 'Ravi Kumar', rating: 5, comment: 'Absolutely beautiful sandalwood carvings! Worth every penny.', date: '2024-01-15' },
        { artisanId: 1, name: 'Priya Sharma', rating: 5, comment: 'Amazing craftsmanship and rich heritage story.', date: '2024-01-10' },
        { artisanId: 2, name: 'Amit Patel', rating: 4, comment: 'Best Mysore Pak I\'ve ever tasted!', date: '2024-01-12' },
        { artisanId: 3, name: 'Sunita Reddy', rating: 5, comment: 'Beautiful silk sarees with authentic designs.', date: '2024-01-08' },
        { artisanId: 4, name: 'Anita Iyer', rating: 5, comment: 'Wonderful experience learning traditional folk music.', date: '2024-01-18' }
    ],
    applications: [
        { id: 1, name: 'Spice Market Kitchen', type: 'traditional-food', description: 'Authentic local spices and cooking experiences', location: 'Devaraja Market', contact: '+91 98765 43222', status: 'pending', date: '2024-01-10' },
        { id: 2, name: 'Mysore Wooden Toys Workshop', type: 'handicrafts', description: 'Traditional wooden toys made by local artisans', location: 'Chamundi Hills Road', contact: '+91 98765 43223', status: 'pending', date: '2024-01-12' }
    ]
};

// Initialize data from server API or use default data
async function initializeData() {
    try {
        // Load data for each category separately from server
        data.artisans = await loadCategoryFromServer('artisans') || data.artisans;
        data.places = await loadCategoryFromServer('places') || data.places;
        data.experiences = await loadCategoryFromServer('experiences') || data.experiences;
        data.food = await loadCategoryFromServer('food') || data.food;
        data.locations = await loadCategoryFromServer('locations') || data.locations;
        data.reviews = await loadCategoryFromServer('reviews') || data.reviews;
        data.applications = await loadCategoryFromServer('applications') || data.applications;
    } catch (error) {
        console.warn('Could not load data from server, using default data:', error);
        // Use default data if server load fails
    }
    
    // Update IDs to continue from the highest existing ID
    updateNextIds();
}

// Function to load data by category from server
async function loadCategoryFromServer(category) {
    try {
        const response = await fetch(`/api/data/${category}`);
        if (response.ok) {
            return await response.json();
        }
        return null;
    } catch (error) {
        console.error(`Error loading ${category} data from server:`, error);
        return null;
    }
}

// Function to save data by category to server
async function saveDataByCategory(category, data) {
    try {
        const response = await fetch(`/api/data/${category}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        });
        
        if (!response.ok) {
            throw new Error(`Failed to save ${category} data: ${response.status}`);
        }
        
        return await response.json();
    } catch (error) {
        console.error(`Error saving ${category} data to server:`, error);
        return { success: false, error: error.message };
    }
}

// Function to save all data to server by category
async function saveDataToStorage() {
    await saveDataByCategory('artisans', data.artisans);
    await saveDataByCategory('places', data.places);
    await saveDataByCategory('experiences', data.experiences);
    await saveDataByCategory('food', data.food);
    await saveDataByCategory('locations', data.locations);
    await saveDataByCategory('reviews', data.reviews);
    await saveDataByCategory('applications', data.applications);
}

// Function to save data to localStorage
function saveDataToStorage() {
    const dataToSave = {
        artisans: data.artisans,
        places: data.places,
        experiences: data.experiences,
        food: data.food,
        locations: data.locations,
        reviews: data.reviews,
        applications: data.applications
    };
    localStorage.setItem('mysuruUnexploredData', JSON.stringify(dataToSave));
}

// Helper function to get data by type
function getDataByType(type) {
    switch(type) {
        case 'artisans':
            return data.artisans;
        case 'places':
            return data.places;
        case 'experiences':
            return data.experiences;
        case 'food':
            return data.food;
        case 'locations':
            return data.locations;
        case 'reviews':
            return data.reviews;
        case 'applications':
            return data.applications;
        default:
            return null;
    }
}

// Variables to track next available IDs
let nextArtisanId = 1;
let nextPlaceId = 1;
let nextExperienceId = 1;
let nextFoodId = 1;

// Function to update next IDs based on current data
function updateNextIds() {
    nextArtisanId = Math.max(...data.artisans.map(item => item.id), 0) + 1;
    nextPlaceId = Math.max(...data.places.map(item => item.id), 0) + 1;
    nextExperienceId = Math.max(...data.experiences.map(item => item.id), 0) + 1;
    nextFoodId = Math.max(...data.food.map(item => item.id), 0) + 1;
}

// Function to add a new listing
async function addListing(type, listingData) {
    const newListing = {
        ...listingData,
        id: getNextId(type),
        rating: listingData.rating || 0,
        distance: listingData.distance || 'N/A',
        verified: listingData.verified || false,
        approved: listingData.approved !== undefined ? listingData.approved : true,
        coordinates: listingData.coordinates || [12.2958, 76.6392] // Default Mysore coordinates
    };
    
    switch(type) {
        case 'artisans':
            data.artisans.push(newListing);
            break;
        case 'places':
            data.places.push(newListing);
            break;
        case 'experiences':
            data.experiences.push(newListing);
            break;
        case 'food':
            data.food.push(newListing);
            break;
        default:
            console.error('Invalid listing type:', type);
            return false;
    }
    
    // Save to server by category
    await saveDataByCategory(type, getDataByType(type));
    
    // Update next ID
    updateNextIds();
    
    return newListing;
}

// Function to update an existing listing
async function updateListing(type, id, updatedData) {
    let listingArray;
    
    switch(type) {
        case 'artisans':
            listingArray = data.artisans;
            break;
        case 'places':
            listingArray = data.places;
            break;
        case 'experiences':
            listingArray = data.experiences;
            break;
        case 'food':
            listingArray = data.food;
            break;
        default:
            console.error('Invalid listing type:', type);
            return false;
    }
    
    const index = listingArray.findIndex(item => item.id == id);
    if (index !== -1) {
        listingArray[index] = { ...listingArray[index], ...updatedData };
        
        // Save to server by category
        await saveDataByCategory(type, listingArray);
        return true;
    }
    
    return false;
}

// Function to delete a listing
async function deleteListingFromType(type, id) {
    let listingArray;
    
    switch(type) {
        case 'artisans':
            listingArray = data.artisans;
            break;
        case 'places':
            listingArray = data.places;
            break;
        case 'experiences':
            listingArray = data.experiences;
            break;
        case 'food':
            listingArray = data.food;
            break;
        default:
            console.error('Invalid listing type:', type);
            return false;
    }
    
    const initialLength = listingArray.length;
    const filteredArray = listingArray.filter(item => item.id != id);
    
    if (filteredArray.length !== initialLength) {
        // Update the array reference
        switch(type) {
            case 'artisans':
                data.artisans = filteredArray;
                break;
            case 'places':
                data.places = filteredArray;
                break;
            case 'experiences':
                data.experiences = filteredArray;
                break;
            case 'food':
                data.food = filteredArray;
                break;
        }
        
        // Save to server by category
        await saveDataByCategory(type, filteredArray);
        return true;
    }
    
    return false;
}

// Helper function to get next ID for a specific type
function getNextId(type) {
    switch(type) {
        case 'artisans':
            return nextArtisanId++;
        case 'places':
            return nextPlaceId++;
        case 'experiences':
            return nextExperienceId++;
        case 'food':
            return nextFoodId++;
        default:
            return 1;
    }
}

// State management
let currentUser = null;
let currentView = 'home';
let selectedCategory = null;
let searchQuery = '';
let cartItems = [];
let savedItems = [];
let map = null;
let heatmapLayer = null;
let markers = [];
let currentMapCategory = 'all';
let isHeatmapActive = false;

// DOM Elements
const elements = {
    searchInput: null,
    searchBtn: null,
    categoryGrid: null,
    featuredGrid: null,
    navbar: null,
    hamburger: null,
    navMenu: null,
    loginModal: null,
    addArtisanBtn: null,
    findAlternativesBtn: null,
    mainLoginBtn: null,
    artisanLoginBtn: null,
    adminNavItem: null,
    pages: {},
    activePage: null
};

// Initialize the application
async function initApp() {
    await initializeData(); // Load data from server
    initializeElements();
    initializeEventListeners();
    initializePages();
    renderHomepage();
    animateOnScroll();
    
    // Initialize map after a short delay to ensure DOM is ready
    setTimeout(initializeMap, 1000);
    
    // Ensure all interactive elements have event listeners
    ensureAllInteractions();
}

// Call the async init function
document.addEventListener('DOMContentLoaded', initApp);

function initializeElements() {
    elements.searchInput = document.getElementById('search-input') || document.querySelector('.search-container input');
    elements.searchBtn = document.getElementById('search-button') || document.querySelector('.search-btn');
    elements.categoryGrid = document.querySelector('.category-grid');
    elements.featuredGrid = document.getElementById('featured-grid');
    elements.navbar = document.querySelector('.navbar');
    elements.hamburger = document.querySelector('.hamburger');
    elements.navMenu = document.querySelector('.nav-menu');
    elements.adminNavItem = document.getElementById('admin-nav-item');
    
    // Get specific buttons
    elements.addArtisanBtn = document.getElementById('add-artisan-btn');
    elements.findAlternativesBtn = document.getElementById('find-alternatives-btn');
    elements.mainLoginBtn = document.getElementById('main-login-btn');
    elements.artisanLoginBtn = document.getElementById('artisan-login-btn');
    
    // Get all page sections
    elements.pages = {
        home: document.getElementById('home'),
        explore: document.getElementById('explore'),
        artisans: document.getElementById('artisans'),
        maps: document.getElementById('maps'),
        sustainability: document.getElementById('sustainability'),
        admin: document.getElementById('admin')
    };
    
    elements.activePage = elements.pages.home;
}

function initializePages() {
    // Initially hide all pages except home
    Object.keys(elements.pages).forEach(pageId => {
        const page = elements.pages[pageId];
        if (pageId !== 'home') {
            page.classList.remove('active');
            page.style.display = 'none';
        } else {
            page.classList.add('active');
            page.style.display = 'block';
        }
    });
}

function initializeEventListeners() {
    // Mobile navigation
    if (elements.hamburger && elements.navMenu) {
        elements.hamburger.addEventListener('click', toggleMobileMenu);
    }
    
    // Navigation links
    document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const pageId = this.getAttribute('data-page');
            if (pageId) {
                goToPage(pageId);
            }
        });
    });
    
    // Close menu when clicking on a link
    document.querySelectorAll('.nav-menu a').forEach((link, index) => {
        link.addEventListener('click', function() {
            closeMobileMenu();
            // Update active state
            document.querySelectorAll('.nav-menu a').forEach(a => a.classList.remove('active'));
            this.classList.add('active');
        });
    });
    
    // Close menu when clicking close button
    const closeMenuButton = document.querySelector('.close-menu');
    if (closeMenuButton) {
        closeMenuButton.addEventListener('click', closeMobileMenu);
    }
    
    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
        const isClickInsideNav = elements.navMenu.contains(event.target) || 
                              elements.hamburger.contains(event.target);
        
        if (elements.navMenu.classList.contains('active') && !isClickInsideNav) {
            closeMobileMenu();
        }
    });
    
    // Search functionality
    if (elements.searchInput) {
        elements.searchInput.addEventListener('keypress', handleSearchInput);
        elements.searchInput.addEventListener('input', debounce(handleSearchInputRealTime, 300));
    }
    
    if (elements.searchBtn) {
        elements.searchBtn.addEventListener('click', handleSearchClick);
    }
    
    // Login functionality
    if (elements.mainLoginBtn) {
        elements.mainLoginBtn.addEventListener('click', showLoginModal);
    }
    
    if (elements.artisanLoginBtn) {
        elements.artisanLoginBtn.addEventListener('click', showArtisanLoginModal);
    }
    
    // Button interactions
    if (elements.addArtisanBtn) {
        elements.addArtisanBtn.addEventListener('click', showArtisanRegistration);
    }
    
    if (elements.findAlternativesBtn) {
        elements.findAlternativesBtn.addEventListener('click', handleFindAlternatives);
    }
    
    // Rating interactions
    document.addEventListener('click', handleRatingClick);
    
    // Window scroll event for animations
    window.addEventListener('scroll', animateOnScroll);
    
    // Add event listeners to featured cards
    document.querySelectorAll('.featured-card').forEach(card => {
        card.addEventListener('click', function(e) {
            // Don't trigger if clicking on a button inside the card
            if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
                return;
            }
            
            const artisanName = this.querySelector('h3').textContent;
            const artisan = data.artisans.find(a => a.name === artisanName);
            if (artisan) {
                showArtisanDetails(artisan);
            }
        });
    });
    
    // Add event listeners to category cards
    document.querySelectorAll('.category-card').forEach(card => {
        card.addEventListener('click', function(e) {
            // Don't trigger if clicking on a button inside the card
            if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
                return;
            }
            
            const categoryId = this.getAttribute('data-category');
            if (categoryId) {
                showCategory(categoryId);
            }
        });
    });
    
    // Add mouse wheel scrolling to category grid
    const categoryGrid = document.querySelector('.category-grid');
    if (categoryGrid) {
        categoryGrid.addEventListener('wheel', (evt) => {
            evt.preventDefault();
            categoryGrid.scrollBy({
                left: evt.deltaY,
                behavior: 'smooth'
            });
        });
        
        // Update gradient indicators based on scroll position
        const updateScrollIndicator = () => {
            const scrollLeft = categoryGrid.scrollLeft;
            const maxScroll = categoryGrid.scrollWidth - categoryGrid.clientWidth;
            
            if (scrollLeft <= 0) {
                categoryGrid.classList.add('at-start');
                categoryGrid.classList.remove('at-end');
            } else if (scrollLeft >= maxScroll - 1) {
                categoryGrid.classList.add('at-end');
                categoryGrid.classList.remove('at-start');
            } else {
                categoryGrid.classList.remove('at-start', 'at-end');
            }
        };
        
        // Initial update
        updateScrollIndicator();
        
        // Add scroll event listener
        categoryGrid.addEventListener('scroll', updateScrollIndicator);
    }
    
    // Function to scroll category grid with buttons
    window.scrollCategoryGrid = function(direction) {
        const grid = document.querySelector('.category-grid');
        if (grid) {
            const scrollAmount = grid.clientWidth * 0.8; // Scroll 80% of container width
            grid.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        }
    };
    
    // Explore page filters
    const locationFilter = document.getElementById('location-filter');
    const categoryFilter = document.getElementById('category-filter');
    
    if (locationFilter) {
        locationFilter.addEventListener('change', filterExploreItems);
    }
    
    if (categoryFilter) {
        categoryFilter.addEventListener('change', filterExploreItems);
    }
    
    // Form submissions
    const loginForm = document.getElementById('login-form');
    const registerForm = document.getElementById('register-form');
    const artisanRegistrationForm = document.getElementById('artisan-registration-form');
    const adminAddListingForm = document.getElementById('admin-add-listing-form');
    
    if (loginForm) {
        loginForm.addEventListener('submit', handleLoginSubmit);
    }
    
    if (registerForm) {
        registerForm.addEventListener('submit', handleRegisterSubmit);
    }
    
    if (artisanRegistrationForm) {
        artisanRegistrationForm.addEventListener('submit', handleArtisanRegistrationSubmit);
    }
    
    if (adminAddListingForm) {
        adminAddListingForm.addEventListener('submit', handleAdminAddListingSubmit);
    }
    
    // Tab switching for modals
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const tab = this.getAttribute('data-tab');
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
            this.classList.add('active');
            document.getElementById(`${tab}-form`).classList.add('active');
        });
    });
}

function goToPage(pageId) {
    // Hide current page
    if (elements.activePage) {
        elements.activePage.classList.remove('active');
        elements.activePage.style.display = 'none';
    }
    
    // Check if user is admin and trying to access admin page
    if (pageId === 'admin' && (!currentUser || currentUser.type !== 'admin')) {
        showToast('Access denied. Admin privileges required.', 'error');
        return;
    }
    
    // Show new page
    const newPage = elements.pages[pageId];
    if (newPage) {
        newPage.classList.add('active');
        newPage.style.display = 'block';
        elements.activePage = newPage;
        
        // Update active navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('data-page') === pageId) {
                link.classList.add('active');
            }
        });
        
        // Special handling for different pages
        switch(pageId) {
            case 'home':
                renderHomepage();
                break;
            case 'explore':
                renderExplorePage();
                break;
            case 'artisans':
                renderArtisansPage();
                break;
            case 'maps':
                refreshMap();
                break;
            case 'sustainability':
                // Nothing special needed
                break;
            case 'admin':
                renderAdminDashboard();
                break;
        }
    }
}

function renderHomepage() {
    if (elements.featuredGrid) {
        elements.featuredGrid.innerHTML = '';
        // Show first 6 artisans as featured
        const featuredArtisans = data.artisans.filter(a => a.approved).slice(0, 6);
        featuredArtisans.forEach(artisan => {
            const artisanCard = createArtisanCard(artisan);
            elements.featuredGrid.appendChild(artisanCard);
        });
    }
}

function createExploreCard(item) {
    const card = document.createElement('div');
    card.className = 'featured-card';
    card.dataset.location = item.location.toLowerCase().replace(/ /g, '-');
    
    // Set category based on the actual category field in the data
    let categoryValue = item.category.toLowerCase();
    if (item.category === 'Local Artisans') {
        categoryValue = 'local-artisans';
    } else if (item.category === 'Traditional Food') {
        categoryValue = 'traditional-food';
    } else if (item.category === 'Cultural Experiences') {
        categoryValue = 'cultural-experiences';
    } else if (item.category === 'Hidden Places') {
        categoryValue = 'hidden-places';
    }
    card.dataset.category = categoryValue;
    
    card.onclick = () => {
        if (item.type === 'artisan' || item.type === 'place' || item.type === 'experience' || item.type === 'food') {
            showExploreItemDetails(item);
        }
    };

    card.innerHTML = `
        <img src="${item.image}" alt="${item.name}">
        <div class="card-content">
            <h3>${item.name}</h3>
            <p>${item.description}</p>
            <div class="rating">
                <span class="stars">${generateStars(item.rating)}</span>
                <span class="distance">${item.distance}</span>
            </div>
            <div class="price-category">
                <span class="price">${item.price}</span>
                <span class="category">${item.category}</span>
            </div>
            ${item.verified ? '<span class="verified-badge">✓ Verified</span>' : ''}
        </div>
    `;

    return card;
}

function showExploreItemDetails(item) {
    // Create modal for item details
    let modal = document.getElementById('explore-item-modal');
    if (modal) {
        modal.remove();
    }

    const reviews = data.reviews.filter(r => r.artisanId === item.id);

    const modalHTML = `
    <div id="explore-item-modal" class="modal">
        <div class="modal-content artisan-details">
            <span class="close" onclick="closeModal('explore-item-modal')">&times;</span>
            <img src="${item.image}" alt="${item.name}">
            <div class="artisan-header">
                <h2>${item.name}</h2>
                <div class="rating-large">
                    <span class="stars-large">${generateStars(item.rating)}</span>
                    <span class="rating-value">${item.rating}/5 (${reviews.length} reviews)</span>
                    ${item.verified ? '<span class="verified-badge-large">✓ Verified</span>' : ''}
                </div>
            </div>
            <p class="description">${item.description}</p>
            <div class="highlights">
                <h4>Highlights:</h4>
                <div class="highlight-tags">
                    ${item.highlights.map(h => `<span class="highlight-tag">${h}</span>`).join('')}
                </div>
            </div>
            <div class="details-grid">
                <div class="detail-item">
                    <strong>📍 Location:</strong> ${item.location}
                </div>
                <div class="detail-item">
                    <strong>🏢 Address:</strong> ${item.address}
                </div>
                <div class="detail-item">
                    <strong>🕒 Hours:</strong> ${item.hours || 'N/A'}
                </div>
                <div class="detail-item">
                    <strong>📞 Contact:</strong> ${item.contact}
                </div>
                <div class="detail-item">
                    <strong>✉️ Email:</strong> ${item.email}
                </div>
                <div class="detail-item">
                    <strong>💰 Price Range:</strong> ${item.price}
                </div>
            </div>
            <div class="story-section">
                <h4>About:</h4>
                <p>${item.story || item.description}</p>
            </div>
            <div class="reviews-section">
                <h4>Recent Reviews:</h4>
                <div class="reviews-list">
                    ${reviews.slice(0, 3).map(review => `
                        <div class="review-item">
                            <div class="review-header">
                                <span class="reviewer">${review.name}</span>
                                <span class="review-stars">${generateStars(review.rating)}</span>
                            </div>
                            <p class="review-comment">${review.comment}</p>
                            <span class="review-date">${formatDate(review.date)}</span>
                        </div>
                    `).join('')}
                </div>
            </div>
            <div class="actions">
                <button class="btn-primary" onclick="contactItem(${item.id})">
                    <i class="fas fa-phone"></i> Contact
                </button>
                <button class="btn-secondary" onclick="saveItem(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                    <i class="fas fa-bookmark"></i> Save for Later
                </button>
            </div>
        </div>
    </div>
    `;

    document.body.insertAdjacentHTML('beforeend', modalHTML);

    // Add event listeners
    document.querySelector('#explore-item-modal .close').addEventListener('click', () => {
        document.getElementById('explore-item-modal').remove();
    });

    // Close modal when clicking outside
    document.getElementById('explore-item-modal').onclick = function(event) {
        if (event.target === this) {
            this.remove();
        }
    };
}

function contactItem(itemId) {
    if (!currentUser) {
        showLoginModal();
        return;
    }

    showToast(`Sending contact request. They will reach out to you soon!`, 'success');
}

function saveItem(itemObj) {
    const item = typeof itemObj === 'string' ? JSON.parse(itemObj.replace(/&quot;/g, '"')) : itemObj;

    if (!currentUser) {
        showLoginModal();
        return;
    }

    // Check if already saved
    const alreadySaved = savedItems.some(savedItem => savedItem.id === item.id);
    if (alreadySaved) {
        showToast('This item is already in your saved list!', 'info');
        return;
    }

    savedItems.push(item);
    showToast(`"${item.name}" saved to your list!`, 'success');
}

function renderArtisansPage() {
    const artisansGrid = document.getElementById('artisans-grid');
    if (artisansGrid) {
        artisansGrid.innerHTML = '';
        // Show all approved artisans
        const approvedArtisans = data.artisans.filter(a => a.approved);
        approvedArtisans.forEach(artisan => {
            if (artisan.category === 'Local Artisans') {
                const artisanCard = createArtisanCard(artisan);
                artisansGrid.appendChild(artisanCard);
            }
        });
    }
}

function renderAdminDashboard() {
    if (currentUser && currentUser.type === 'admin') {
        // Update stats
        document.getElementById('total-listings-count').textContent = data.artisans.length;
        document.getElementById('new-applications-count').textContent = data.applications.filter(app => app.status === 'pending').length;
        
        // Count reviews from today
        const today = new Date().toISOString().split('T')[0];
        const todaysReviews = data.reviews.filter(r => r.date === today);
        document.getElementById('reviews-today-count').textContent = todaysReviews.length;
        
        // Count verified listings
        const verifiedListings = data.artisans.filter(a => a.verified);
        document.getElementById('verified-listings-count').textContent = verifiedListings.length;
        
        // Load listings for admin
        loadAdminListings();
    } else {
        showToast('Access denied. Admin privileges required.', 'error');
        goToPage('home');
    }
}

function loadAdminListings() {
    const container = document.getElementById('admin-listings-container');
    if (!container) return;
    
    container.innerHTML = '<h3>All Listings</h3>';
    
    const listingsGrid = document.createElement('div');
    listingsGrid.className = 'admin-listings-grid';
    listingsGrid.style.display = 'grid';
    listingsGrid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(300px, 1fr))';
    listingsGrid.style.gap = '20px';
    listingsGrid.style.marginTop = '20px';
    
    data.artisans.forEach(artisan => {
        const listingCard = document.createElement('div');
        listingCard.className = 'admin-listing-card';
        listingCard.style.border = '1px solid #ddd';
        listingCard.style.borderRadius = '8px';
        listingCard.style.padding = '15px';
        listingCard.style.backgroundColor = '#fff';
        
        listingCard.innerHTML = `
            <h4>${artisan.name}</h4>
            <p><strong>Category:</strong> ${artisan.category}</p>
            <p><strong>Location:</strong> ${artisan.location}</p>
            <p><strong>Rating:</strong> ${artisan.rating}/5</p>
            <p><strong>Status:</strong> ${artisan.approved ? 'Approved' : 'Pending'}</p>
            <p><strong>Verified:</strong> ${artisan.verified ? 'Yes' : 'No'}</p>
            <div style="margin-top: 10px;">
                <button class="btn-primary" style="margin-right: 10px;" onclick="editListing(${artisan.id})">Edit</button>
                <button class="btn-secondary" onclick="deleteListing(${artisan.id})">Delete</button>
            </div>
        `;
        
        listingsGrid.appendChild(listingCard);
    });
    
    container.appendChild(listingsGrid);
}

function showAddListingForm() {
    const modal = document.getElementById('admin-add-listing-modal');
    if (modal) {
        modal.style.display = 'block';
        
        // Reset form
        document.getElementById('admin-add-listing-form').reset();
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        };
    }
}

function showPendingApplications() {
    if (!currentUser || currentUser.type !== 'admin') {
        showToast('Access denied. Admin privileges required.', 'error');
        return;
    }
    
    const pendingApps = data.applications.filter(app => app.status === 'pending');
    
    let appsHtml = '<h3>Pending Applications</h3>';
    if (pendingApps.length > 0) {
        appsHtml += '<div style="margin-top: 20px;">';
        pendingApps.forEach(app => {
            appsHtml += `
                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 15px; background: #fff;">
                    <h4>${app.name}</h4>
                    <p><strong>Type:</strong> ${app.type}</p>
                    <p><strong>Description:</strong> ${app.description}</p>
                    <p><strong>Location:</strong> ${app.location}</p>
                    <p><strong>Contact:</strong> ${app.contact}</p>
                    <p><strong>Date:</strong> ${app.date}</p>
                    <div style="margin-top: 10px;">
                        <button class="btn-primary" style="margin-right: 10px;" onclick="approveApplication(${app.id})">Approve</button>
                        <button class="btn-secondary" onclick="rejectApplication(${app.id})">Reject</button>
                    </div>
                </div>
            `;
        });
        appsHtml += '</div>';
    } else {
        appsHtml += '<p>No pending applications.</p>';
    }
    
    document.getElementById('admin-listings-container').innerHTML = appsHtml;
}

function showEditListings() {
    loadAdminListings();
}

function showAnalytics() {
    // Placeholder for analytics page
    document.getElementById('admin-listings-container').innerHTML = `
        <h3>Analytics Dashboard</h3>
        <p>Platform usage statistics, visitor trends, and performance metrics would be displayed here.</p>
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
            <div style="background: #f5f5f5; padding: 15px; border-radius: 8px;">
                <h4>Total Visitors</h4>
                <p style="font-size: 24px; font-weight: bold;">1,248</p>
            </div>
            <div style="background: #e8f5e9; padding: 15px; border-radius: 8px;">
                <h4>Engagement Rate</h4>
                <p style="font-size: 24px; font-weight: bold;">78%</p>
            </div>
            <div style="background: #fff3e0; padding: 15px; border-radius: 8px;">
                <h4>Conversion Rate</h4>
                <p style="font-size: 24px; font-weight: bold;">12%</p>
            </div>
            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                <h4>Return Visitors</h4>
                <p style="font-size: 24px; font-weight: bold;">34%</p>
            </div>
        </div>
    `;
}

function approveApplication(appId) {
    const app = data.applications.find(a => a.id === appId);
    if (app) {
        app.status = 'approved';
        
        // Add to artisans list as pending approval
        const newArtisan = {
            id: data.artisans.length + 1,
            name: app.name,
            description: app.description,
            rating: 4.0,
            distance: '0.0 km away',
            category: 'Local Artisans',
            subcategory: app.type,
            image: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w0NTYyMDF8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NjYyMTQ1MTh8&ixlib=rb-4.1.0&q=80&w=400',
            location: app.location,
            address: app.location,
            hours: 'TBD',
            contact: app.contact,
            email: 'pending@example.com',
            story: 'New listing awaiting details',
            highlights: ['New Addition'],
            price: 'TBD',
            verified: false,
            coordinates: [12.2958, 76.6392], // Default to center of Mysore
            approved: false // Will be approved by admin later
        };
        
        data.artisans.push(newArtisan);
        showToast(`Application ${app.name} approved and added to listings.`, 'success');
        renderAdminDashboard();
    }
}

function rejectApplication(appId) {
    const appIndex = data.applications.findIndex(a => a.id === appId);
    if (appIndex !== -1) {
        data.applications.splice(appIndex, 1);
        showToast('Application rejected and removed.', 'info');
        renderAdminDashboard();
    }
}

function editListing(id) {
    // Try to find the item in any of the data categories
    let item = null;
    let type = null;
    
    // Check each category
    item = data.artisans.find(a => a.id == id);
    if (item) {
        type = 'artisans';
    } else {
        item = data.places.find(p => p.id == id);
        if (item) type = 'places';
        else {
            item = data.experiences.find(e => e.id == id);
            if (item) type = 'experiences';
            else {
                item = data.food.find(f => f.id == id);
                if (item) type = 'food';
            }
        }
    }
    
    if (item) {
        // Fill the add listing form with current values
        document.getElementById('listing-name').value = item.name;
        document.getElementById('listing-category').value = item.category.toLowerCase().replace(/\s+/g, '-');
        document.getElementById('listing-description').value = item.description;
        document.getElementById('listing-location').value = item.location;
        document.getElementById('listing-address').value = item.address;
        document.getElementById('listing-contact').value = item.contact;
        document.getElementById('listing-rating').value = item.rating;
        document.getElementById('listing-price').value = item.price;
        document.getElementById('listing-image').value = item.image;
        document.getElementById('listing-highlights').value = item.highlights.join(', ');
        document.getElementById('listing-verified').checked = item.verified;
        
        // Change form to update mode
        const form = document.getElementById('admin-add-listing-form');
        form.onsubmit = function(e) {
            e.preventDefault();
            updateListingById(id, type);
        };
            
        // Add image preview functionality
        const imageUpload = document.getElementById('listing-image-upload');
        const imagePreview = document.getElementById('image-preview');
            
        imageUpload.onchange = function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                    
                reader.onload = function(event) {
                    imagePreview.innerHTML = `<img src="${event.target.result}" style="max-width: 200px; max-height: 150px; border-radius: 8px; margin-top: 10px;">`;
                };
                    
                reader.readAsDataURL(file);
            }
        };
        
        // Change button text
        const submitBtn = form.querySelector('button[type="submit"]');
        submitBtn.textContent = 'Update Listing';
        
        // Show the form
        const modal = document.getElementById('admin-add-listing-modal');
        if (modal) {
            modal.style.display = 'block';
        }
    }
}

function updateListingById(id, type) {
    // Handle image update
    const imageInput = document.getElementById('listing-image');
    const imageUpload = document.getElementById('listing-image-upload');
    
    // Check if a new image was uploaded
    if (imageUpload.files && imageUpload.files[0]) {
        const file = imageUpload.files[0];
        const reader = new FileReader();
        
        reader.onload = function(e) {
            // Create updated data object
            const updatedData = {
                name: document.getElementById('listing-name').value,
                category: document.getElementById('listing-category').value.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
                description: document.getElementById('listing-description').value,
                location: document.getElementById('listing-location').value,
                address: document.getElementById('listing-address').value,
                contact: document.getElementById('listing-contact').value,
                rating: parseFloat(document.getElementById('listing-rating').value),
                price: document.getElementById('listing-price').value,
                image: e.target.result, // Use uploaded image
                highlights: document.getElementById('listing-highlights').value.split(',').map(h => h.trim()).filter(h => h),
                verified: document.getElementById('listing-verified').checked
            };
            
            // Update the listing using the new function
            const success = updateListing(type, id, updatedData);
            
            if (success) {
                showToast(`Listing updated successfully.`, 'success');
                
                // Reset form to add mode
                document.getElementById('admin-add-listing-form').onsubmit = handleAdminAddListingSubmit;
                const submitBtn = document.getElementById('admin-add-listing-form').querySelector('button[type="submit"]');
                submitBtn.textContent = 'Add Listing';
                
                // Close modal
                closeModal('admin-add-listing-modal');
                
                // Refresh listings
                loadAdminListings();
                
                // Update UI across all sections to reflect changes
                updateUIAfterDataChange();
            } else {
                showToast('Error updating listing. Please try again.', 'error');
            }
        };
        
        reader.readAsDataURL(file);
    } else {
        // Use the URL from the text field
        const updatedData = {
            name: document.getElementById('listing-name').value,
            category: document.getElementById('listing-category').value.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
            description: document.getElementById('listing-description').value,
            location: document.getElementById('listing-location').value,
            address: document.getElementById('listing-address').value,
            contact: document.getElementById('listing-contact').value,
            rating: parseFloat(document.getElementById('listing-rating').value),
            price: document.getElementById('listing-price').value,
            image: document.getElementById('listing-image').value, // Use provided URL
            highlights: document.getElementById('listing-highlights').value.split(',').map(h => h.trim()).filter(h => h),
            verified: document.getElementById('listing-verified').checked
        };
        
        // Update the listing using the new function
        const success = updateListing(type, id, updatedData);
        
        if (success) {
            showToast(`Listing updated successfully.`, 'success');
            
            // Reset form to add mode
            document.getElementById('admin-add-listing-form').onsubmit = handleAdminAddListingSubmit;
            const submitBtn = document.getElementById('admin-add-listing-form').querySelector('button[type="submit"]');
            submitBtn.textContent = 'Add Listing';
            
            // Close modal
            closeModal('admin-add-listing-modal');
            
            // Refresh listings
            loadAdminListings();
            
            // Update UI across all sections to reflect changes
            updateUIAfterDataChange();
        } else {
            showToast('Error updating listing. Please try again.', 'error');
        }
    }
}

function deleteListing(id) {
    // Try to find the item in any of the data categories
    let item = null;
    let type = null;
    
    // Check each category
    item = data.artisans.find(a => a.id == id);
    if (item) {
        type = 'artisans';
    } else {
        item = data.places.find(p => p.id == id);
        if (item) type = 'places';
        else {
            item = data.experiences.find(e => e.id == id);
            if (item) type = 'experiences';
            else {
                item = data.food.find(f => f.id == id);
                if (item) type = 'food';
            }
        }
    }
    
    if (item && confirm('Are you sure you want to delete this listing?')) {
        // Use the new delete function
        const success = deleteListingFromType(type, id);
        
        if (success) {
            showToast('Listing deleted successfully.', 'info');
            loadAdminListings();
            
            // Update UI across all sections to reflect changes
            updateUIAfterDataChange();
        } else {
            showToast('Error deleting listing. Please try again.', 'error');
        }
    }
}

function filterExploreItems() {
    const locationFilter = document.getElementById('location-filter');
    const categoryFilter = document.getElementById('category-filter');
    
    let location = 'all';
    let category = 'all';
    
    if (locationFilter) location = locationFilter.value;
    if (categoryFilter) category = categoryFilter.value;
    
    console.log('Selected location:', location);
    console.log('Selected category:', category);
    
    const exploreGrid = document.getElementById('explore-grid');
    if (exploreGrid) {
        // Get all cards in the grid
        const cards = exploreGrid.querySelectorAll('.featured-card');
        
        let visibleCount = 0;
        
        cards.forEach(card => {
            const cardLocation = card.dataset.location || '';
            const cardCategory = card.dataset.category || '';
            
            console.log('Card location:', cardLocation, 'Card category:', cardCategory);
            
            // Check if card matches filters
            const locationMatch = location === 'all' || cardLocation.includes(location);
            const categoryMatch = category === 'all' || cardCategory.includes(category);
            
            // Show/hide card based on filter matches
            if (locationMatch && categoryMatch) {
                card.style.display = 'block';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });
        
        // Remove any existing no-results message
        const existingNoResults = exploreGrid.querySelector('.no-results');
        if (existingNoResults) {
            existingNoResults.remove();
        }
        
        // If no cards are visible and filters are active, show no results message
        if (visibleCount === 0 && (location !== 'all' || category !== 'all')) {
            exploreGrid.innerHTML = '<p class="no-results">No items found matching your filters.</p>';
        } else if (visibleCount === 0 && location === 'all' && category === 'all') {
            // If no cards at all (shouldn't happen with our data)
            exploreGrid.innerHTML = '<p class="no-results">No items available.</p>';
        }
    }
}

// Add event listeners to dropdowns for dynamic filtering
function setupFilterEventListeners() {
    const locationFilter = document.getElementById('location-filter');
    const categoryFilter = document.getElementById('category-filter');
    
    if (locationFilter) {
        locationFilter.addEventListener('change', function() {
            console.log('Location filter changed to:', locationFilter.value);
            filterExploreItems();
        });
    }
    
    if (categoryFilter) {
        categoryFilter.addEventListener('change', function() {
            console.log('Category filter changed to:', categoryFilter.value);
            filterExploreItems();
        });
    }
}

// Initialize filter event listeners when page loads
window.addEventListener('load', function() {
    setupFilterEventListeners();
});

function createArtisanCard(artisan) {
    const card = document.createElement('div');
    card.className = 'featured-card';
    card.dataset.location = artisan.location.toLowerCase();
    card.dataset.category = artisan.subcategory.toLowerCase();
    card.onclick = () => showArtisanDetails(artisan);

    card.innerHTML = `
        <img src="${artisan.image}" alt="${artisan.name}">
        <div class="card-content">
            <h3>${artisan.name}</h3>
            <p>${artisan.description}</p>
            <div class="rating">
                <span class="stars">${generateStars(artisan.rating)}</span>
                <span class="distance">${artisan.distance}</span>
            </div>
            <div class="price-category">
                <span class="price">${artisan.price}</span>
                <span class="category">${artisan.category}</span>
            </div>
            ${artisan.verified ? '<span class="verified-badge">✓ Verified</span>' : ''}
        </div>
    `;

    return card;
}

// Update the renderExplorePage function to use the new approach
function renderExplorePage() {
    // Populate the explore grid with all items
    const exploreGrid = document.getElementById('explore-grid');
    if (exploreGrid) {
        exploreGrid.innerHTML = '';
        
        // Combine all data sources
        const allItems = [];
        
        // Add artisans
        data.artisans.forEach(artisan => {
            allItems.push({
                ...artisan,
                type: 'artisan'
            });
        });
        
        // Add places
        data.places.forEach(place => {
            allItems.push({
                ...place,
                type: 'place'
            });
        });
        
        // Add experiences
        data.experiences.forEach(exp => {
            allItems.push({
                ...exp,
                type: 'experience'
            });
        });
        
        // Add food items
        data.food.forEach(food => {
            allItems.push({
                ...food,
                type: 'food'
            });
        });
        
        // Create cards for all items
        allItems.forEach(item => {
            const itemCard = createExploreCard(item);
            exploreGrid.appendChild(itemCard);
        });
    }
    
    // Wait for DOM to be ready before setting up filters
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            filterExploreItems();
            setupFilterEventListeners();
        });
    } else {
        filterExploreItems();
        setupFilterEventListeners();
    }
}

function generateStars(rating) {
    let stars = '';
    const fullStars = Math.floor(rating);
    const hasHalfStar = rating % 1 !== 0;

    for (let i = 0; i < fullStars; i++) {
        stars += '<i class="fas fa-star"></i>';
    }

    if (hasHalfStar) {
        stars += '<i class="fas fa-star-half-alt"></i>';
    }

    const emptyStars = 5 - Math.ceil(rating);
    for (let i = 0; i < emptyStars; i++) {
        stars += '<i class="far fa-star"></i>';
    }

    return stars;
}

function showArtisanDetails(artisan) {
    // Create modal for artisan details
    let modal = document.getElementById('artisan-modal');
    if (modal) {
        modal.remove();
    }

    const reviews = data.reviews.filter(r => r.artisanId === artisan.id);

    const modalHTML = `
    <div id="artisan-modal" class="modal">
        <div class="modal-content artisan-details">
            <span class="close" onclick="closeModal('artisan-modal')">&times;</span>
            <img src="${artisan.image}" alt="${artisan.name}">
            <div class="artisan-header">
                <h2>${artisan.name}</h2>
                <div class="rating-large">
                    <span class="stars-large">${generateStars(artisan.rating)}</span>
                    <span class="rating-value">${artisan.rating}/5 (${reviews.length} reviews)</span>
                    ${artisan.verified ? '<span class="verified-badge-large">✓ Verified Artisan</span>' : ''}
                </div>
            </div>
            <p class="description">${artisan.description}</p>
            <div class="highlights">
                <h4>Highlights:</h4>
                <div class="highlight-tags">
                    ${artisan.highlights.map(h => `<span class="highlight-tag">${h}</span>`).join('')}
                </div>
            </div>
            <div class="details-grid">
                <div class="detail-item">
                    <strong>📍 Location:</strong> ${artisan.location}
                </div>
                <div class="detail-item">
                    <strong>🏢 Address:</strong> ${artisan.address}
                </div>
                <div class="detail-item">
                    <strong>🕒 Hours:</strong> ${artisan.hours}
                </div>
                <div class="detail-item">
                    <strong>📞 Contact:</strong> ${artisan.contact}
                </div>
                <div class="detail-item">
                    <strong>✉️ Email:</strong> ${artisan.email}
                </div>
                <div class="detail-item">
                    <strong>💰 Price Range:</strong> ${artisan.price}
                </div>
            </div>
            <div class="story-section">
                <h4>About:</h4>
                <p>${artisan.story}</p>
            </div>
            <div class="reviews-section">
                <h4>Recent Reviews:</h4>
                <div class="reviews-list">
                    ${reviews.slice(0, 3).map(review => `
                        <div class="review-item">
                            <div class="review-header">
                                <span class="reviewer">${review.name}</span>
                                <span class="review-stars">${generateStars(review.rating)}</span>
                            </div>
                            <p class="review-comment">${review.comment}</p>
                            <span class="review-date">${formatDate(review.date)}</span>
                        </div>
                    `).join('')}
                </div>
            </div>
            <div class="actions">
                <button class="btn-primary" onclick="contactArtisan(${artisan.id})">
                    <i class="fas fa-phone"></i> Contact Artisan
                </button>
                <button class="btn-secondary" onclick="saveArtisan(${JSON.stringify(artisan).replace(/"/g, '&quot;')})">
                    <i class="fas fa-bookmark"></i> Save for Later
                </button>
            </div>
        </div>
    </div>
    `;

    document.body.insertAdjacentHTML('beforeend', modalHTML);

    // Add event listeners
    document.querySelector('#artisan-modal .close').addEventListener('click', () => {
        document.getElementById('artisan-modal').remove();
    });

    // Close modal when clicking outside
    document.getElementById('artisan-modal').onclick = function(event) {
        if (event.target === this) {
            this.remove();
        }
    };
}

function formatDate(dateString) {
    const options = { year: 'numeric', month: 'short', day: 'numeric' };
    return new Date(dateString).toLocaleDateString(undefined, options);
}

function contactArtisan(artisanId) {
    if (!currentUser) {
        showLoginModal();
        return;
    }

    showToast(`Sending contact request to artisan. They will reach out to you soon!`, 'success');
}

function saveArtisan(artisanObj) {
    const artisan = typeof artisanObj === 'string' ? JSON.parse(artisanObj.replace(/&quot;/g, '"')) : artisanObj;

    if (!currentUser) {
        showLoginModal();
        return;
    }

    // Check if already saved
    const alreadySaved = savedItems.some(item => item.id === artisan.id);
    if (alreadySaved) {
        showToast('This item is already in your saved list!', 'info');
        return;
    }

    savedItems.push(artisan);
    showToast(`"${artisan.name}" saved to your list!`, 'success');
}

function showCategory(categoryId) {
    selectedCategory = categoryId;
    currentView = 'category';
    
    // Update active state in navigation
    document.querySelectorAll('.category-card').forEach(card => {
        card.classList.remove('active');
        if (card.getAttribute('data-category') === categoryId) {
            card.classList.add('active');
        }
    });
    
    // Go to explore page and filter by category
    goToPage('explore');
    
    // Set the category filter
    const categoryFilter = document.getElementById('category-filter');
    if (categoryFilter) {
        categoryFilter.value = categoryId;
        filterExploreItems();
    }
    
    // Update explore title
    const exploreTitle = document.getElementById('explore-title');
    if (exploreTitle) {
        const categoryNames = {
            'hidden-places': 'Hidden Places',
            'local-artisans': 'Local Artisans',
            'cultural-experiences': 'Cultural Experiences',
            'traditional-food': 'Traditional Food'
        };
        exploreTitle.textContent = categoryNames[categoryId] || 'Explore Mysuru';
    }
}

function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

function toggleMobileMenu() {
    elements.navMenu.classList.toggle('active');
    if (elements.hamburger) {
        elements.hamburger.classList.toggle('active');
    }
}

function closeMobileMenu() {
    elements.navMenu.classList.remove('active');
    if (elements.hamburger) {
        elements.hamburger.classList.remove('active');
    }
}

function smoothScroll(e) {
    e.preventDefault();

    const targetId = this.getAttribute('href');
    if (targetId === '#' || !targetId.startsWith('#')) return;

    const targetElement = document.querySelector(targetId);
    if (targetElement) {
        window.scrollTo({
            top: targetElement.offsetTop - 80,
            behavior: 'smooth'
        });
    }
}

function handleSearchInput(e) {
    if (e.key === 'Enter') {
        performSearch(elements.searchInput.value);
    }
}

function handleSearchInputRealTime() {
    // Real-time search as user types
    if (elements.searchInput) {
        searchQuery = elements.searchInput.value.toLowerCase();
        if (searchQuery.length > 2) {
            renderSearchResults();
        } else if (searchQuery.length === 0) {
            renderHomepage();
        }
    }
}

function handleSearchClick() {
    performSearch(elements.searchInput.value);
}

function performSearch(query) {
    if (query.trim() !== '') {
        searchQuery = query.toLowerCase();
        renderSearchResults();
    } else {
        renderHomepage();
    }
}

function renderSearchResults() {
    // Filter all data types based on search query
    const filteredArtisans = data.artisans.filter(item => 
        item.approved &&
        (item.name.toLowerCase().includes(searchQuery) ||
        item.description.toLowerCase().includes(searchQuery) ||
        item.category.toLowerCase().includes(searchQuery) ||
        item.subcategory.toLowerCase().includes(searchQuery) ||
        item.location.toLowerCase().includes(searchQuery) ||
        item.highlights.some(h => h.toLowerCase().includes(searchQuery)))
    );
    
    const filteredPlaces = data.places.filter(item => 
        item.approved &&
        (item.name.toLowerCase().includes(searchQuery) ||
        item.description.toLowerCase().includes(searchQuery) ||
        item.category.toLowerCase().includes(searchQuery) ||
        item.subcategory.toLowerCase().includes(searchQuery) ||
        item.location.toLowerCase().includes(searchQuery) ||
        item.highlights.some(h => h.toLowerCase().includes(searchQuery)))
    );
    
    const filteredExperiences = data.experiences.filter(item => 
        item.approved &&
        (item.name.toLowerCase().includes(searchQuery) ||
        item.description.toLowerCase().includes(searchQuery) ||
        item.category.toLowerCase().includes(searchQuery) ||
        item.subcategory.toLowerCase().includes(searchQuery) ||
        item.location.toLowerCase().includes(searchQuery) ||
        item.highlights.some(h => h.toLowerCase().includes(searchQuery)))
    );
    
    const filteredFood = data.food.filter(item => 
        item.approved &&
        (item.name.toLowerCase().includes(searchQuery) ||
        item.description.toLowerCase().includes(searchQuery) ||
        item.category.toLowerCase().includes(searchQuery) ||
        item.subcategory.toLowerCase().includes(searchQuery) ||
        item.location.toLowerCase().includes(searchQuery) ||
        item.highlights.some(h => h.toLowerCase().includes(searchQuery)))
    );
    
    // Combine all results
    const allResults = [...filteredArtisans, ...filteredPlaces, ...filteredExperiences, ...filteredFood];
    
    // For search results, we'll show them on the explore page
    goToPage('explore');
    
    const exploreGrid = document.getElementById('explore-grid');
    if (exploreGrid) {
        exploreGrid.innerHTML = '';
        
        if (allResults.length > 0) {
            allResults.forEach(item => {
                const itemCard = createExploreCard(item); // Using the general card creation function
                exploreGrid.appendChild(itemCard);
            });
        } else {
            exploreGrid.innerHTML = `
                <div class="no-results">
                    <i class="fas fa-search"></i>
                    <h3>No results found for "${searchQuery}"</h3>
                    <p>Try different keywords or explore our featured categories!</p>
                </div>
            `;
        }
    }
}

function showLoginModal() {
    const modal = document.getElementById('login-modal');
    if (modal) {
        // Update modal content to show role selection
        modal.innerHTML = `
            <div class="modal-content">
                <span class="close" onclick="closeModal('login-modal')">&times;</span>
                <h2>Login to Mysuru Unexplored</h2>
                <div class="role-selector">
                    <p>Select your role to continue:</p>
                    <div class="role-options">
                        <button class="role-option" onclick="showLoginForm('tourist')">
                            <i class="fas fa-user"></i>
                            <h3>Tourist</h3>
                            <p>Explore hidden places, artisans, and experiences</p>
                        </button>
                        <button class="role-option" onclick="showLoginForm('artisan')">
                            <i class="fas fa-hands"></i>
                            <h3>Artisan</h3>
                            <p>Manage your listings and profile</p>
                        </button>
                        <button class="role-option" onclick="showLoginForm('admin')">
                            <i class="fas fa-cog"></i>
                            <h3>Admin</h3>
                            <p>Manage platform and listings</p>
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        modal.style.display = 'block';
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        };
    }
}

function showLoginForm(role) {
    const modal = document.getElementById('login-modal');
    if (modal) {
        // Update modal content to show login form
        modal.innerHTML = `
            <div class="modal-content">
                <span class="close" onclick="closeModal('login-modal')">&times;</span>
                <h2>${role.charAt(0).toUpperCase() + role.slice(1)} Login</h2>
                <form id="login-form" onsubmit="handleLoginSubmit(event, '${role}')">
                    <input type="hidden" id="user-type" value="${role}">
                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" required placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="password">Password:</label>
                        <input type="password" id="password" required placeholder="Enter your password">
                    </div>
                    <button type="submit" class="btn-primary">Login as ${role.charAt(0).toUpperCase() + role.slice(1)}</button>
                </form>
                <p class="switch-form">
                    Don't have an account? <a href="#" onclick="showRegisterForm('${role}')">Register</a>
                </p>
                <p class="switch-form">
                    <a href="#" onclick="showLoginModal()">Back to Role Selection</a>
                </p>
            </div>
        `;
    }
}

function showRegisterForm(role) {
    const modal = document.getElementById('login-modal');
    if (modal) {
        // Update modal content to show registration form
        modal.innerHTML = `
            <div class="modal-content">
                <span class="close" onclick="closeModal('login-modal')">&times;</span>
                <h2>Register as ${role.charAt(0).toUpperCase() + role.slice(1)}</h2>
                <form id="register-form" onsubmit="handleRegisterSubmit(event, '${role}')">
                    <input type="hidden" id="reg-user-type" value="${role}">
                    <div class="form-group">
                        <label for="reg-name">Full Name:</label>
                        <input type="text" id="reg-name" required placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label for="reg-email">Email:</label>
                        <input type="email" id="reg-email" required placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="reg-password">Password:</label>
                        <input type="password" id="reg-password" required placeholder="Create a password">
                    </div>
                    <button type="submit" class="btn-primary">Register as ${role.charAt(0).toUpperCase() + role.slice(1)}</button>
                </form>
                <p class="switch-form">
                    Already have an account? <a href="#" onclick="showLoginForm('${role}')">Login</a>
                </p>
                <p class="switch-form">
                    <a href="#" onclick="showLoginModal()">Back to Role Selection</a>
                </p>
            </div>
        `;
    }
}

function showArtisanLoginModal() {
    // For artisan login, we'll direct them to registration
    showToast('Artisans can register using the "Become an Artisan" button', 'info');
    showArtisanRegistration();
}

function showArtisanRegistration() {
    const modal = document.getElementById('artisan-registration-modal');
    if (modal) {
        modal.style.display = 'block';
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        };
    }
}

function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'none';
    }
}

function handleLoginSubmit(e, role = null) {
    e.preventDefault();
    
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    const userType = role || document.getElementById('user-type').value;
    
    // Simulate login with loading effect
    const submitBtn = e.target.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.textContent = 'Logging in...';
    submitBtn.disabled = true;
    
    setTimeout(() => {
        // Simulate successful login
        currentUser = {
            email: email,
            type: userType,
            name: email.split('@')[0],
            joinDate: new Date().toISOString().split('T')[0]
        };
        
        // Close modal
        document.getElementById('login-modal').style.display = 'none';
        
        // Update navigation to show user info
        updateNavigationAfterLogin();
        
        // Reset button
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
        
        showToast(`Welcome back, ${currentUser.name}!`, 'success');
    }, 1000);
}

function handleRegisterSubmit(e, role = null) {
    e.preventDefault();
    
    const name = document.getElementById('reg-name').value;
    const email = document.getElementById('reg-email').value;
    const password = document.getElementById('reg-password').value;
    const userType = role || document.getElementById('reg-user-type').value;
    
    // Simulate registration
    const submitBtn = e.target.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.textContent = 'Registering...';
    submitBtn.disabled = true;
    
    setTimeout(() => {
        // Simulate successful registration
        currentUser = {
            email: email,
            type: userType,
            name: name,
            joinDate: new Date().toISOString().split('T')[0]
        };
        
        // Close modal
        document.getElementById('login-modal').style.display = 'none';
        
        // Update navigation to show user info
        updateNavigationAfterLogin();
        
        // Reset button
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
        
        showToast(`Welcome, ${currentUser.name}! Registration successful.`, 'success');
    }, 1500);
}

function handleArtisanRegistrationSubmit(e) {
    e.preventDefault();
    
    const name = document.getElementById('artisan-name').value;
    const type = document.getElementById('artisan-type').value;
    const description = document.getElementById('artisan-description').value;
    const location = document.getElementById('artisan-location').value;
    const address = document.getElementById('artisan-address').value;
    const contact = document.getElementById('artisan-contact').value;
    const email = document.getElementById('artisan-email').value;
    const hours = document.getElementById('artisan-hours').value;
    const season = document.getElementById('artisan-season').value;
    
    // Create application
    const newApplication = {
        id: data.applications.length + 1,
        name: name,
        type: type,
        description: description,
        location: location,
        address: address,
        contact: contact,
        email: email,
        hours: hours,
        season: season,
        status: 'pending',
        date: new Date().toISOString().split('T')[0]
    };
    
    data.applications.push(newApplication);
    
    // Simulate submission
    const submitBtn = e.target.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.textContent = 'Submitting...';
    submitBtn.disabled = true;
    
    setTimeout(() => {
        // In a real app, this would send to a server
        showToast(`Thank you! Your application "${name}" has been submitted for review. We'll contact you at ${email}.`, 'success');
        
        // Reset form
        e.target.reset();
        
        // Close modal
        document.getElementById('artisan-registration-modal').style.display = 'none';
        
        // Reset button
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
    }, 1500);
}

async function handleAdminAddListingSubmit(e) {
    e.preventDefault();
    
    const name = document.getElementById('listing-name').value;
    const category = document.getElementById('listing-category').value;
    const description = document.getElementById('listing-description').value;
    const location = document.getElementById('listing-location').value;
    const address = document.getElementById('listing-address').value;
    const contact = document.getElementById('listing-contact').value;
    const rating = parseFloat(document.getElementById('listing-rating').value);
    const price = document.getElementById('listing-price').value;
    const imageInput = document.getElementById('listing-image');
    const imageUpload = document.getElementById('listing-image-upload');
    const highlights = document.getElementById('listing-highlights').value.split(',').map(h => h.trim()).filter(h => h);
    const verified = document.getElementById('listing-verified').checked;
    
    // Determine the type based on the category
    let type;
    if (category.includes('artisan')) {
        type = 'artisans';
    } else if (category.includes('place') || category.includes('hidden')) {
        type = 'places';
    } else if (category.includes('experience') || category.includes('cultural')) {
        type = 'experiences';
    } else if (category.includes('food') || category.includes('traditional')) {
        type = 'food';
    } else {
        // Default to artisans if category is ambiguous
        type = 'artisans';
    }
    
    // Check if a file was uploaded
    if (imageUpload.files && imageUpload.files[0]) {
        // For now, we'll use a placeholder. In a real app, you'd upload to a server.
        const file = imageUpload.files[0];
        const reader = new FileReader();
        
        // Define an async function to handle the file load and listing creation
        const handleFileLoad = async function(e) {
            const image = e.target.result;
            
            // Create new listing data object
            const listingData = {
                name: name,
                description: description,
                rating: rating,
                distance: '0.0 km away',
                category: category.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
                subcategory: category,
                image: image,
                location: location,
                address: address,
                hours: 'TBD',
                contact: contact,
                email: 'admin-added@example.com',
                story: 'Added by administrator',
                highlights: highlights,
                price: price,
                verified: verified,
                coordinates: [12.2958, 76.6392], // Default to center of Mysore
                approved: true
            };
            
            // Add the listing using the new async function
            const newListing = await addListing(type, listingData);
            
            if (newListing) {
                // Simulate addition
                const submitBtn = document.querySelector('button[type="submit"]');
                const originalText = submitBtn.textContent;
                submitBtn.textContent = 'Adding...';
                submitBtn.disabled = true;
                
                setTimeout(() => {
                    showToast(`Listing "${name}" added successfully.`, 'success');
                    
                    // Reset form
                    document.getElementById('admin-add-listing-form').reset();
                    
                    // Clear image preview
                    document.getElementById('image-preview').innerHTML = '';
                    
                    // Close modal
                    document.getElementById('admin-add-listing-modal').style.display = 'none';
                    
                    // Reset button
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                    
                    // Refresh admin listings
                    loadAdminListings();
                    
                    // Update UI across all sections to reflect changes
                    updateUIAfterDataChange();
                }, 1000);
            } else {
                showToast('Error adding listing. Please try again.', 'error');
            }
        };
        
        reader.onload = handleFileLoad;
        
        reader.readAsDataURL(file);
    } else {
        // Use the URL from the text field
        const image = imageInput.value;
        
        // Create new listing data object
        const listingData = {
            name: name,
            description: description,
            rating: rating,
            distance: '0.0 km away',
            category: category.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
            subcategory: category,
            image: image,
            location: location,
            address: address,
            hours: 'TBD',
            contact: contact,
            email: 'admin-added@example.com',
            story: 'Added by administrator',
            highlights: highlights,
            price: price,
            verified: verified,
            coordinates: [12.2958, 76.6392], // Default to center of Mysore
            approved: true
        };
        
        // Add the listing using the new async function
        const newListing = await addListing(type, listingData);
        
        if (newListing) {
            // Simulate addition
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Adding...';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                showToast(`Listing "${name}" added successfully.`, 'success');
                
                // Reset form
                document.getElementById('admin-add-listing-form').reset();
                
                // Clear image preview
                document.getElementById('image-preview').innerHTML = '';
                
                // Close modal
                document.getElementById('admin-add-listing-modal').style.display = 'none';
                
                // Reset button
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                
                // Refresh admin listings
                loadAdminListings();
                
                // Update UI across all sections to reflect changes
                updateUIAfterDataChange();
            }, 1000);
        } else {
            showToast('Error adding listing. Please try again.', 'error');
        }
    }
}

function updateNavigationAfterLogin() {
    if (elements.mainLoginBtn) {
        elements.mainLoginBtn.innerHTML = `
            <i class="fas fa-user-circle"></i>
            <span>${currentUser.name}</span>
        `;
        elements.mainLoginBtn.className = 'btn-profile';
        elements.mainLoginBtn.onclick = function() {
            showUserProfile();
        };
        
        // Update navigation based on user role
        updateRoleSpecificNav(currentUser.type);
    }
    
    // Update artisan login button text
    if (elements.artisanLoginBtn) {
        if (currentUser.type === 'artisan') {
            elements.artisanLoginBtn.innerHTML = 'My Profile';
        } else {
            elements.artisanLoginBtn.innerHTML = 'Artisan Portal';
        }
    }
}

function updateRoleSpecificNav(role) {
    // Hide/show navigation items based on role
    const navLinks = document.querySelectorAll('.nav-link[data-page]');
    
    navLinks.forEach(link => {
        const pageId = link.getAttribute('data-page');
        
        // Show/hide specific pages based on role
        if (pageId === 'admin' && role !== 'admin') {
            link.closest('li').style.display = 'none';
        } else if (pageId === 'admin' && role === 'admin') {
            link.closest('li').style.display = 'list-item';
        } else if (pageId === 'artisan-portal' && role === 'artisan') {
            link.closest('li').style.display = 'list-item';
        } else if (pageId === 'favorites' && role === 'tourist') {
            link.closest('li').style.display = 'list-item';
        }
    });
    
    // Show/hide admin navigation item based on role
    if (elements.adminNavItem) {
        if (role === 'admin') {
            elements.adminNavItem.style.display = 'list-item';
            // Ensure the admin nav item has the correct content
            if (!elements.adminNavItem.querySelector('[data-page="admin"]')) {
                elements.adminNavItem.innerHTML = '<a href="#" class="nav-link" data-page="admin" onclick="goToPage(\'admin\')">Admin Panel</a>';
            }
        } else if (role === 'artisan') {
            elements.adminNavItem.style.display = 'list-item';
            // Update the content of the admin nav item for artisans
            elements.adminNavItem.innerHTML = '<a href="#" class="nav-link" data-page="artisan-portal" onclick="goToPage(\'artisan-portal\')">My Listings</a>';
        } else {
            elements.adminNavItem.style.display = 'none';
        }
    }
}

function showUserProfile() {
    const profileModalHTML = `
    <div id="profile-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('profile-modal')">&times;</span>
            <h2>User Profile</h2>
            <div class="profile-info">
                <p><strong>Name:</strong> ${currentUser.name}</p>
                <p><strong>Email:</strong> ${currentUser.email}</p>
                <p><strong>Type:</strong> ${currentUser.type}</p>
                <p><strong>Member Since:</strong> ${currentUser.joinDate}</p>
                <p><strong>Saved Items:</strong> ${savedItems.length}</p>
                <p><strong>Cart Items:</strong> ${cartItems.length}</p>
            </div>
            <div class="profile-actions">
                <button class="btn-primary" onclick="viewSavedItems()">View Saved Items</button>
                <button class="btn-secondary" onclick="logoutUser()">Logout</button>
            </div>
        </div>
    </div>
    `;
    
    // Remove any existing profile modal
    const existingModal = document.getElementById('profile-modal');
    if (existingModal) existingModal.remove();
    
    document.body.insertAdjacentHTML('beforeend', profileModalHTML);
    
    // Add event listeners
    document.querySelector('#profile-modal .close').addEventListener('click', () => {
        document.getElementById('profile-modal').remove();
    });
    
    // Close modal when clicking outside
    document.getElementById('profile-modal').onclick = function(event) {
        if (event.target === this) {
            this.remove();
        }
    };
}

function viewSavedItems() {
    if (savedItems.length === 0) {
        showToast('No saved items yet.', 'info');
        return;
    }
    
    const savedModalHTML = `
    <div id="saved-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('saved-modal')">&times;</span>
            <h2>Saved Items (${savedItems.length})</h2>
            <div class="saved-items-list">
                ${savedItems.map(item => `
                    <div class="saved-item">
                        <img src="${item.image}" alt="${item.name}" />
                        <div class="saved-item-info">
                            <h4>${item.name}</h4>
                            <p>${item.description}</p>
                            <div class="saved-item-actions">
                                <button class="btn-primary" onclick="showArtisanDetails(${JSON.stringify(item).replace(/"/g, '&quot;')})">View Details</button>
                                <button class="btn-secondary" onclick="removeFromSaved(${item.id})">Remove</button>
                            </div>
                        </div>
                    </div>
                `).join('')}
            </div>
        </div>
    </div>
    `;
    
    // Remove any existing saved modal
    const existingModal = document.getElementById('saved-modal');
    if (existingModal) existingModal.remove();
    
    document.body.insertAdjacentHTML('beforeend', savedModalHTML);
    
    // Add event listeners
    document.querySelector('#saved-modal .close').addEventListener('click', () => {
        document.getElementById('saved-modal').remove();
    });
    
    // Close modal when clicking outside
    document.getElementById('saved-modal').onclick = function(event) {
        if (event.target === this) {
            this.remove();
        }
    };
}

function removeFromSaved(artisanId) {
    savedItems = savedItems.filter(item => item.id !== artisanId);
    document.getElementById('saved-modal').remove();
    showToast('Item removed from saved list.', 'info');
}

function logoutUser() {
    currentUser = null;
    
    // Update navigation
    if (elements.mainLoginBtn) {
        elements.mainLoginBtn.innerHTML = 'Login';
        elements.mainLoginBtn.className = 'btn-login';
        elements.mainLoginBtn.onclick = function() {
            showLoginModal();
        };
        
        // Hide admin nav item
        if (elements.adminNavItem) {
            elements.adminNavItem.style.display = 'none';
        }
    }
    
    // Reset navigation to default state
    const navLinks = document.querySelectorAll('.nav-link[data-page]');
    navLinks.forEach(link => {
        const pageId = link.getAttribute('data-page');
        // Show all default pages
        if (['admin', 'artisan-portal', 'favorites'].includes(pageId)) {
            link.closest('li').style.display = 'none';
        } else {
            link.closest('li').style.display = 'list-item';
        }
    });
    
    // Close profile modal if open
    const profileModal = document.getElementById('profile-modal');
    if (profileModal) profileModal.remove();
    
    showToast('Logged out successfully.', 'info');
}

function handleAddArtisan() {
    if (!currentUser) {
        showLoginModal();
        return;
    }
    
    if (currentUser.type !== 'artisan' && currentUser.type !== 'admin') {
        showToast('Please register as an artisan first.', 'warning');
        showArtisanRegistration();
        return;
    }
    
    showArtisanRegistration();
}

function handleFindAlternatives() {
    // Get current location data
    const crowdedLocations = data.locations.filter(loc => 
        loc.population === 'High' || loc.density > 0.7
    );
    
    const peacefulLocations = data.locations.filter(loc => 
        loc.population === 'Low' || loc.density <= 0.3
    );
    
    if (crowdedLocations.length === 0 && peacefulLocations.length === 0) {
        showToast('No location data available for alternatives.', 'info');
        return;
    }
    
    const altModalHTML = `
    <div id="alt-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('alt-modal')">&times;</span>
            <h2>Less Crowded Alternatives</h2>
            <p>Looking for peaceful experiences away from the crowds?</p>
            
            ${crowdedLocations.length > 0 ? `
            <div class="crowded-section">
                <h3>Currently Busy Areas:</h3>
                <div class="alternatives-list">
                    ${crowdedLocations.map(loc => `
                        <div class="alternative-item crowded">
                            <h4>${loc.name}</h4>
                            <p>Crowd Level: ${loc.crowdLevel}</p>
                            <p>Density: ${(loc.density * 100).toFixed(0)}%</p>
                        </div>
                    `).join('')}
                </div>
            </div>
            ` : ''}
            
            ${peacefulLocations.length > 0 ? `
            <div class="peaceful-section">
                <h3>Peaceful Alternatives:</h3>
                <div class="alternatives-list">
                    ${peacefulLocations.map(loc => `
                        <div class="alternative-item peaceful">
                            <h4>${loc.name}</h4>
                            <p>Crowd Level: ${loc.crowdLevel}</p>
                            <p>Density: ${(loc.density * 100).toFixed(0)}%</p>
                        </div>
                    `).join('')}
                </div>
            </div>
            ` : ''}
            
            <div class="tips-section">
                <h3>Tips for Better Experience:</h3>
                <ul>
                    <li>Visit popular locations during weekdays</li>
                    <li>Consider early morning or late evening visits</li>
                    <li>Explore the alternative locations suggested above</li>
                    <li>Check the map for real-time crowd density</li>
                </ul>
            </div>
        </div>
    </div>
    `;
    
    // Remove any existing alt modal
    const existingModal = document.getElementById('alt-modal');
    if (existingModal) existingModal.remove();
    
    document.body.insertAdjacentHTML('beforeend', altModalHTML);
    
    // Add event listeners
    const closeBtn = document.querySelector('#alt-modal .close');
    if (closeBtn) {
        closeBtn.addEventListener('click', () => {
            const modal = document.getElementById('alt-modal');
            if (modal) modal.remove();
        });
    }
    
    // Close modal when clicking outside
    const modal = document.getElementById('alt-modal');
    if (modal) {
        modal.onclick = function(event) {
            if (event.target === this) {
                this.remove();
            }
        };
    }
}

function handleRatingClick(e) {
    if (e.target.classList.contains('rating') || e.target.classList.contains('fa-star')) {
        const ratingContainer = e.target.closest('.rating');
        if (ratingContainer) {
            const stars = ratingContainer.querySelectorAll('.fa-star, .fa-star-half-alt, .fa-star-half, .far.fa-star');
            const clickedStar = e.target.classList.contains('fa-star') || e.target.classList.contains('fa-star-half-alt') || e.target.classList.contains('fa-star-half') ? 
                               e.target : e.target.parentElement?.querySelector('.fa-star, .fa-star-half-alt, .fa-star-half');
            
            if (clickedStar) {
                // Calculate rating based on clicked star
                const starIndex = Array.from(stars).indexOf(clickedStar) + 1;
                
                // Update star colors to show rating
                stars.forEach((star, index) => {
                    if (index < starIndex) {
                        star.className = 'fas fa-star';
                    } else {
                        star.className = 'far fa-star';
                    }
                });
                
                // Show rating feedback
                showToast(`Thank you for rating ${starIndex} stars!`, 'success');
            }
        }
    }
}

function animateOnScroll() {
    const elements = document.querySelectorAll('.fade-in');
    elements.forEach(element => {
        const elementTop = element.getBoundingClientRect().top;
        const elementVisible = 150;

        if (elementTop < window.innerHeight - elementVisible) {
            element.classList.add('active');
        }
    });
}

function showToast(message, type = 'info') {
    // Remove any existing toast
    const existingToast = document.querySelector('.toast');
    if (existingToast) existingToast.remove();
    
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;
    toast.textContent = message;
    
    document.body.appendChild(toast);
    
    // Show toast
    setTimeout(() => {
        toast.classList.add('show');
    }, 100);
    
    // Hide toast after 3 seconds
    setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
            if (toast.parentNode) {
                toast.parentNode.removeChild(toast);
            }
        }, 300);
    }, 3000);
}

// Map functionality
function initializeMap() {
    if (typeof L !== 'undefined') {
        // Initialize the map centered on Mysore
        map = L.map('main-map').setView([12.2958, 76.6392], 13);

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Add markers for all artisans and locations
        addMapMarkers();
    }
}

function addMapMarkers() {
    if (!map) return;
    
    // Clear existing markers
    markers.forEach(marker => map.removeLayer(marker));
    markers = [];
    
    // Add markers for artisans
    data.artisans.filter(a => a.approved).forEach(artisan => {
        if (artisan.coordinates) {
            const marker = L.marker(artisan.coordinates)
                .addTo(map)
                .bindPopup(`
                    <b>${artisan.name}</b><br>
                    ${artisan.category}<br>
                    ${artisan.location}<br>
                    Rating: ${artisan.rating}/5
                `);
            markers.push(marker);
        }
    });
    
    // Add markers for places
    data.places.filter(p => p.approved).forEach(place => {
        if (place.coordinates) {
            const marker = L.marker(place.coordinates)
                .addTo(map)
                .bindPopup(`
                    <b>${place.name}</b><br>
                    ${place.category}<br>
                    ${place.location}<br>
                    Rating: ${place.rating}/5
                `);
            markers.push(marker);
        }
    });
    
    // Add markers for locations
    data.locations.forEach(location => {
        if (location.coordinates) {
            const color = location.population === 'High' ? 'red' : 
                         location.population === 'Medium' ? 'orange' : 'green';
            
            const circle = L.circle(location.coordinates, {
                color: color,
                fillColor: color,
                fillOpacity: 0.5,
                radius: 500
            }).addTo(map);
            
            circle.bindPopup(`
                <b>${location.name}</b><br>
                Crowd Level: ${location.crowdLevel}<br>
                Population: ${location.population}
            `);
            markers.push(circle);
        }
    });
}

function refreshMap() {
    if (map) {
        setTimeout(() => {
            map.invalidateSize();
        }, 100);
    } else {
        initializeMap();
    }
}

function toggleHeatmap() {
    if (!map) return;
    
    if (isHeatmapActive) {
        // Remove heatmap
        if (heatmapLayer) {
            map.removeLayer(heatmapLayer);
            heatmapLayer = null;
        }
        isHeatmapActive = false;
        showToast('Heatmap turned off', 'info');
    } else {
        // Create heatmap using all location data
        const heatPoints = [];
        
        // Add artisans data to heatmap
        data.artisans.filter(a => a.approved && a.coordinates).forEach(artisan => {
            // Use rating as intensity (higher rating = more intensity)
            heatPoints.push([...artisan.coordinates, artisan.rating]);
        });
        
        // Add places data to heatmap
        data.places.filter(p => p.approved && p.coordinates).forEach(place => {
            // Use rating as intensity (higher rating = more intensity)
            heatPoints.push([...place.coordinates, place.rating]);
        });
        
        // Add locations data to heatmap
        data.locations.forEach(location => {
            if (location.coordinates) {
                // Use population density as intensity
                let intensity = 1;
                if (location.population === 'High') intensity = 3;
                else if (location.population === 'Medium') intensity = 2;
                heatPoints.push([...location.coordinates, intensity]);
            }
        });
        
        // Create heatmap layer
        if (heatPoints.length > 0) {
            heatmapLayer = L.heatLayer(heatPoints, {
                radius: 25,
                blur: 15,
                maxZoom: 16,
                max: 5, // Maximum intensity value
                gradient: { 0.2: 'blue', 0.4: 'lime', 0.6: 'yellow', 0.8: 'orange', 1.0: 'red' }
            }).addTo(map);
        }
        
        isHeatmapActive = true;
        showToast('Heatmap turned on - showing location density', 'info');
    }
}

function showAllCategories() {
    // Reset filters on explore page
    const locationFilter = document.getElementById('location-filter');
    const categoryFilter = document.getElementById('category-filter');
    
    if (locationFilter) locationFilter.value = 'all';
    if (categoryFilter) categoryFilter.value = 'all';
    
    filterExploreItems();
    
    // If on maps page, show all markers
    if (elements.activePage.id === 'maps') {
        addMapMarkers();
    }
}

function ensureAllInteractions() {
    // Add event listeners to all category cards
    document.querySelectorAll('.category-card').forEach(card => {
        if (!card.onclick) {
            const categoryLink = card.querySelector('[data-category]');
            if (categoryLink) {
                const categoryId = categoryLink.getAttribute('data-category');
                card.onclick = () => showCategory(categoryId);
            }
        }
    });
    
    // Add event listeners to all featured cards
    document.querySelectorAll('.featured-card').forEach(card => {
        if (!card.onclick) {
            const img = card.querySelector('img');
            const nameElement = card.querySelector('h3');
            if (img && nameElement) {
                // Extract artisan info from the card
                const name = nameElement.textContent;
                const artisan = data.artisans.find(a => a.name === name);
                if (artisan) {
                    card.onclick = () => showArtisanDetails(artisan);
                }
            }
        }
    });
    
    // Ensure search functionality
    if (elements.searchInput) {
        elements.searchInput.addEventListener('input', debounce(handleSearchInputRealTime, 300));
    }
    
    // Ensure login button works
    const loginBtn = document.querySelector('.btn-login');
    if (loginBtn && !loginBtn.onclick) {
        loginBtn.onclick = showLoginModal;
    }
    
    // Ensure other buttons work
    const addBtn = document.querySelector('.btn-primary');
    if (addBtn && addBtn.textContent.includes('Add')) {
        addBtn.onclick = handleAddArtisan;
    }
    
    const altBtn = document.querySelector('.btn-secondary');
    if (altBtn && altBtn.textContent.includes('Find')) {
        altBtn.onclick = handleFindAlternatives;
    }
    
    // Ensure artisan login button works
    const artisanLoginBtn = document.getElementById('artisan-login-btn');
    if (artisanLoginBtn) {
        artisanLoginBtn.onclick = function(e) {
            e.preventDefault();
            showArtisanRegistration();
        };
    }
}

// Add toast styles
const toastStyles = `
.toast {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 16px 24px;
    border-radius: 8px;
    color: white;
    font-weight: 500;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    transform: translateX(100%);
    transition: transform 0.3s ease;
    z-index: 3000;
    max-width: 300px;
}

.toast.show {
    transform: translateX(0);
}

.toast-success {
    background: linear-gradient(to right, #4CAF50, #2E7D32);
}

.toast-error {
    background: linear-gradient(to right, #F44336, #C62828);
}

.toast-warning {
    background: linear-gradient(to right, #FF9800, #EF6C00);
}

.toast-info {
    background: linear-gradient(to right, #2196F3, #1565C0);
}

.no-results {
    text-align: center;
    padding: 60px 20px;
    color: #795548;
}

.no-results i {
    font-size: 3rem;
    color: #d7ccc8;
    margin-bottom: 20px;
}

.no-results h3 {
    font-size: 1.5rem;
    margin-bottom: 10px;
    color: #5d4037;
}

.no-results p {
    font-size: 1rem;
    color: #795548;
}

.login-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.tab-btn {
    flex: 1;
    padding: 12px;
    border: none;
    background: #f5f5f5;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
}

.tab-btn.active {
    background: linear-gradient(to right, #d32f2f, #e64a19);
    color: white;
}

.auth-form {
    display: none;
}

.auth-form.active {
    display: block;
}

.profile-info {
    text-align: left;
    margin: 20px 0;
}

.profile-info p {
    margin: 10px 0;
    padding: 8px 0;
    border-bottom: 1px solid #eee;
}

.profile-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

.saved-items-list {
    max-height: 400px;
    overflow-y: auto;
    margin-top: 20px;
    width: 100%;
}

.saved-item {
    display: flex;
    gap: 15px;
    padding: 15px;
    border: 1px solid #e0e0e0;
    border-radius: 10px;
    margin-bottom: 10px;
    background: white;
}

.saved-item img {
    width: 80px;
    height: 80px;
    object-fit: cover;
    border-radius: 8px;
}

.saved-item-info {
    flex: 1;
}

.saved-item-info h4 {
    margin: 0 0 5px 0;
    color: #5d4037;
}

.saved-item-info p {
    margin: 0 0 10px 0;
    font-size: 0.9rem;
    color: #795548;
}

.saved-item-actions {
    display: flex;
    gap: 10px;
}

.verified-badge, .verified-badge-large {
    background: linear-gradient(to right, #4CAF50, #2E7D32);
    color: white;
    padding: 4px 10px;
    border-radius: 15px;
    font-size: 0.8rem;
    font-weight: 600;
    display: inline-block;
    margin-top: 5px;
}

.verified-badge-large {
    padding: 6px 12px;
    font-size: 0.9rem;
}

.price-category {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 10px;
}

.price {
    background: linear-gradient(to right, #ffd54f, #ffb300);
    color: #5d4037;
    padding: 4px 10px;
    border-radius: 15px;
    font-size: 0.85rem;
    font-weight: 600;
}

.highlights {
    margin: 20px 0;
}

.highlight-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 10px;
}

.highlight-tag {
    background: linear-gradient(to right, #e3f2fd, #bbdefb);
    color: #1565c0;
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
}

.reviews-section {
    margin: 25px 0;
}

.review-item {
    background: #fff3e0;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 15px;
    border-left: 3px solid #ffd54f;
}

.review-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.reviewer {
    font-weight: 600;
    color: #5d4037;
}

.review-comment {
    margin: 8px 0;
    color: #795548;
    font-style: italic;
}

.review-date {
    font-size: 0.8rem;
    color: #9e9e9e;
}

.stars-large {
    font-size: 1.2rem;
}

.rating-large {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 10px 0;
}

.rating-value {
    font-weight: 600;
    color: #5d4037;
}

.alternatives-list {
    margin: 20px 0;
    max-height: 300px;
    overflow-y: auto;
}

.alternative-item {
    background: white;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 15px;
    border-left: 4px solid #4CAF50;
}

.alternative-item.crowded {
    border-left: 4px solid #F44336;
}

.alternative-item.peaceful {
    border-left: 4px solid #4CAF50;
}

.crowd-tip {
    background: #e8f5e9;
    padding: 15px;
    border-radius: 10px;
    margin-top: 20px;
    border-left: 4px solid #4CAF50;
    font-style: italic;
}

/* Page section styles */
.page-section {
    display: none;
}

.page-section.active {
    display: block;
    min-height: calc(100vh - 80px);
    padding: 20px 0;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    flex-wrap: wrap;
    gap: 15px;
}

.back-btn {
    background: linear-gradient(to right, #795548, #5d4037);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.back-btn:hover {
    background: linear-gradient(to right, #5d4037, #4e342e);
    transform: translateY(-2px);
}

.explore-filters {
    display: flex;
    gap: 15px;
    margin-bottom: 30px;
    flex-wrap: wrap;
}

.explore-filters select {
    padding: 12px;
    border: 2px solid #d7ccc8;
    border-radius: 8px;
    background: white;
    font-size: 1rem;
    min-width: 200px;
}

.maps-container {
    margin-top: 20px;
}

.map-controls {
    display: flex;
    gap: 15px;
    margin-top: 15px;
    flex-wrap: wrap;
}

#artisan-login-btn {
    background: linear-gradient(to right, #8BC34A, #4CAF50);
    color: white !important;
    padding: 10px 15px;
    border-radius: 6px;
    transition: all 0.3s ease;
    font-weight: 500;
    box-shadow: 0 4px 10px rgba(139, 195, 74, 0.3);
    border: none;
    cursor: pointer;
    font-size: 0.9rem;
    margin-left: 10px;
}

#artisan-login-btn:hover {
    background: linear-gradient(to right, #7CB342, #43A047);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(139, 195, 74, 0.4);
}

/* Admin Panel Styles */
.admin-dashboard {
    margin-top: 30px;
}

.admin-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    padding: 20px;
    border-radius: 12px;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.stat-card h3 {
    margin: 0 0 10px 0;
    color: #5d4037;
    font-size: 1rem;
}

.stat-card p {
    margin: 0;
    font-size: 1.8rem;
    font-weight: bold;
    color: #d32f2f;
}

.admin-controls {
    background: white;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 30px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.control-buttons {
    display: flex;
    gap: 15px;
    margin-top: 15px;
    flex-wrap: wrap;
}

.admin-listings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    max-height: 60vh;
    overflow-y: auto;
}

.admin-listing-card {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    background: #fff;
}

.admin-listing-card h4 {
    margin-top: 0;
}

/* Navbar alignment fix */
.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.nav-menu {
    display: flex;
    gap: 20px;
    align-items: center;
    list-style: none;
    margin: 0;
    padding: 0;
}

.nav-menu li {
    margin: 0;
}
`;

// Update UI after data changes
function updateUIAfterDataChange() {
    // Update featured section if it's currently active
    if (elements.activePage && elements.activePage.id === 'home') {
        renderHomepage();
    }
    
    // Update explore section if it's currently active
    if (elements.activePage && elements.activePage.id === 'explore') {
        renderExplorePage();
    }
    
    // Update artisans section if it's currently active
    if (elements.activePage && elements.activePage.id === 'artisans') {
        renderArtisansPage();
    }
    
    // Refresh map if it's currently active
    if (elements.activePage && elements.activePage.id === 'maps') {
        refreshMap();
    }
    
    // Make sure all interactive elements have event listeners
    ensureAllInteractions();
}

// Add toast styles to the page
const styleSheet = document.createElement('style');
styleSheet.innerText = toastStyles;
document.head.appendChild(styleSheet);
